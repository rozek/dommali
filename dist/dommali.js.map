{"version":3,"file":"dommali.js","sources":["../../../../node_modules/tslib/tslib.es6.js","../src/dommali.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","  type Primitive     = null | undefined | boolean | number | string // | symbol | bigint\n  type PlainObject   = Record<string,Primitive>\n\n/**** make some existing types indexable ****/\n\n  interface Indexable { [Key:string]:any }\n\n  type indexableFunction    = Function    & Indexable\n  type indexableElement     = Element     & Indexable\n  type indexableHTMLElement = HTMLElement & Indexable\n  type indexableEvent       = Event       & Indexable\n\n/**** ValueIsString ****/\n\n  function ValueIsString (Value:any):boolean {\n    return (typeof Value === 'string') || (Value instanceof String)\n  }\n\n/**** ValueIsArray ****/\n\n  const ValueIsArray = Array.isArray\n\n/**** asArray ****/\n\n  function asArray (Value:any):any[] {\n    return Array.prototype.slice.call(Value)\n  }\n\n/**** ValueIsHTMLElement ****/\n\n  function ValueIsHTMLElement (Value:any):boolean {\n    return (Value instanceof HTMLElement)\n  }\n\n/**** asHTMLElement ****/\n\n  function asHTMLElement (Candidate:Element):HTMLElement|undefined {\n    return (ValueIsHTMLElement(Candidate) ? Candidate as HTMLElement : undefined)\n  }\n\n/**** asListOfHTMLElements ****/\n\n  function asListOfHTMLElements (Candidates:Element[]):HTMLElement[] {\n    return Candidates.filter(\n      (Candidate) => ValueIsHTMLElement(Candidate)\n    ) as HTMLElement[]\n  }\n\n/**** ValueIsEmptyObject ****/\n\n  let hasOwnProperty = Object.prototype.hasOwnProperty\n  function ValueIsEmptyObject (Value:any):boolean {\n    for (let Key in Value) {\n      if (hasOwnProperty.call(Value,Key)) { return false }\n    }\n    return true\n  }\n\n/**** CamelCased ****/\n\n  function CamelCased (Text:string):string {\n    return Text.replace(/-[a-z]/ig, (Match) => Match[1].toUpperCase())\n  }\n\n/**** DisplayDefaultFor ****/\n\n  const DisplayDefaultSet:{ [TagName:string]:string } = {}\n\n  function DisplayDefaultFor (TagName:string):string {\n    if (TagName in DisplayDefaultSet) { return DisplayDefaultSet[TagName] }\n\n    let auxElement = document.createElement(TagName)\n    document.body.appendChild(auxElement)\n      let DisplayDefault = getComputedStyle(auxElement).display\n      if (DisplayDefault === 'none') { DisplayDefault = 'block' }\n\n      DisplayDefaultSet[TagName] = DisplayDefault\n    document.body.removeChild(auxElement)\n\n    return DisplayDefault\n  }\n/**** unhashed - convert #<id> into [id=\"<id>\"] ****/\n\n  function unhashed (Selector:string):string {\n    return (\n      Selector.startsWith('#')\n      ? '[id=\"' + Selector.slice(1) + '\"]' // not perfect\n      : Selector\n    )\n  }\n\n\n  abstract class DOMMaLi {\n    protected Subjects:Element[] = []\n\n  /**** ready - similar to jQuery.ready ****/\n\n    static ready (\n      this:typeof DOMMaLi, FunctionToCall:Function\n    ):typeof DOMMaLi {\n      if (DOMisReady && ! ReadyFunctionsAreRunning) {\n        FunctionToCall()                                            // may fail!\n      } else {\n        ReadyFunctionsToCall.push(FunctionToCall)\n      }\n      return this\n    }\n\n  /**** textWidth ****/\n\n    private static readonly _relevantSettings_for_textWidth = [\n      'font-family', 'font-size', 'font-weight', 'font-style', 'font-variant',\n      'font-variant-caps', 'font-variant-numeric', 'font-variant-alternates',\n      'font-variant-ligatures', 'font-variant-east-asian', 'font-stretch',\n      'font-kerning', 'font-size-adjust', 'font-synthesis', 'font-language-override',\n      'white-space', 'letter-spacing', 'word-spacing', 'text-indent',\n      'text-transform'\n    ]\n\n    private static _auxiliarySpan:DOMMaLi\n\n    static textWidth (Text:string, TemplateOrSettings?:any):number {\n      if (DOMisReady) {\n        if (_DOMMaLi._auxiliarySpan == null) {\n          let auxiliarySpan = document.createElement('span')\n            auxiliarySpan.style.visibility = 'hidden'\n          document.body.appendChild(auxiliarySpan)\n\n          _DOMMaLi._auxiliarySpan = dommali(auxiliarySpan) as DOMMaLi\n        }\n\n        let auxiliarySpan = _DOMMaLi._auxiliarySpan\n\n        auxiliarySpan.css({   // reset settings that could influence measurement\n          width:'auto', 'min-width':0, 'max-width':'none',\n          margin:0, padding:0, border:'none', font:'normal',\n          'white-space':'normal', 'letter-spacing':'normal', 'word-spacing':'normal',\n          'text-indent':0, 'text-transform':'none'\n        })\n\n        if (TemplateOrSettings) {\n          let Settings:{[Key:string]:string}\n          switch (true) {\n            case (typeof TemplateOrSettings === 'object') && (\n              (Object.getPrototypeOf(TemplateOrSettings) === Object.prototype) ||\n              (Object.getPrototypeOf(TemplateOrSettings) ==  null)\n            ):\n              Settings = TemplateOrSettings\n              break\n            case TemplateOrSettings instanceof DOMMaLi:\n            case TemplateOrSettings instanceof Element:\n// @ts-ignore allow assignment to \"Settings\"\n              Settings = window.getComputedStyle(\n// @ts-ignore dommali(...) does return a DOMMaLi instance\n                dommali(TemplateOrSettings).subject(0)\n              )\n              break\n            default:\n              throw new TypeError('DOMMaLi instance, HTML element or settings expected')\n          }\n\n          _DOMMaLi._relevantSettings_for_textWidth.forEach((relevantSetting) => {\n            const ValueOfSetting = Settings[relevantSetting]\n            if (ValueOfSetting != null) {\n              auxiliarySpan.css(relevantSetting,ValueOfSetting)\n            }\n          })\n        }\n\n// @ts-ignore \"auxiliarySpan\" is defined and \"text\" returns it\n        return auxiliarySpan.text(Text).width()   // performs actual measurement\n      } else {\n        return NaN\n      }\n    }\n\n  /**** textHeight ****/\n\n    private static readonly _relevantSettings_for_textHeight = [\n      'font-family', 'font-size', 'font-weight', 'font-style', 'font-variant',\n      'font-variant-caps', 'font-variant-numeric', 'font-variant-alternates',\n      'font-variant-ligatures', 'font-variant-east-asian', 'font-stretch',\n      'font-kerning', 'font-size-adjust', 'font-synthesis', 'font-language-override',\n      'white-space', 'letter-spacing', 'word-spacing', 'text-indent',\n      'text-transform', 'word-break', 'line-break', 'line-height',\n      'width'                               // width may be explicitly specified\n    ]\n\n    private static _auxiliaryDiv:DOMMaLi\n\n    static textHeight (Text:string, TemplateOrSettings?:any):number {\n      if (DOMisReady) {\n        if (_DOMMaLi._auxiliaryDiv == null) {\n          let auxiliaryDiv = document.createElement('div')\n            auxiliaryDiv.style.visibility = 'hidden'\n          document.body.appendChild(auxiliaryDiv)\n\n          _DOMMaLi._auxiliaryDiv = dommali(auxiliaryDiv) as DOMMaLi\n        }\n\n        let auxiliaryDiv = _DOMMaLi._auxiliaryDiv\n\n        auxiliaryDiv.css({    // reset settings that could influence measurement\n          width:'auto', 'min-width':0, 'max-width':'none',\n          margin:0, padding:0, border:'none', font:'normal',\n          'white-space':'normal', 'letter-spacing':'normal', 'word-spacing':'normal',\n          'text-indent':0, 'text-transform':'none'\n        })\n\n        if (TemplateOrSettings) {\n          let Settings:{[Key:string]:string}\n          switch (true) {\n            case (typeof TemplateOrSettings === 'object') && (\n              (Object.getPrototypeOf(TemplateOrSettings) === Object.prototype) ||\n              (Object.getPrototypeOf(TemplateOrSettings) ==  null)\n            ):\n              Settings = TemplateOrSettings\n              break\n            case TemplateOrSettings instanceof DOMMaLi:\n            case TemplateOrSettings instanceof Element:\n// @ts-ignore allow assignment to \"Settings\"\n              Settings = window.getComputedStyle(\n// @ts-ignore dommali(...) does return a DOMMaLi instance\n                dommali(TemplateOrSettings).subject(0)\n              )\n              break\n            default:\n              throw new TypeError('DOMMaLi instance, HTML element or settings expected')\n          }\n\n          _DOMMaLi._relevantSettings_for_textHeight.forEach((relevantSetting) => {\n            const ValueOfSetting = Settings[relevantSetting]\n            if (ValueOfSetting != null) {\n              auxiliaryDiv.css(relevantSetting,ValueOfSetting)\n            }\n          })\n        }\n\n// @ts-ignore \"auxiliaryDiv\" is defined and \"text\" returns it\n        return auxiliaryDiv.text(Text).height()   // performs actual measurement\n      } else {\n        return NaN\n      }\n    }\n\n\n  /**** get length ****/\n\n    get length ():number {\n      return this.Subjects.length\n    }\n\n  /**** size ****/\n\n    size (this:DOMMaLi):number {\n      return this.Subjects.length\n    }\n\n  /**** isEmpty ****/\n\n    isEmpty (this:DOMMaLi):boolean {\n      return (this.Subjects.length === 0)\n    }\n\n  /**** subjects ****/\n\n    subjects (this:DOMMaLi):Element[] {\n      return this.Subjects.slice()\n    }\n\n  /**** subject ****/\n\n    subject (this:DOMMaLi, Index:number):Element|undefined {\n      return this.Subjects[Index]\n    }\n\n  /**** indexOf ****/\n\n    indexOf (this:DOMMaLi, Value:Element|DOMMaLi):number {\n      if (Value instanceof DOMMaLi) {\n        Value = Value.Subjects[0]\n        if (Value == null) { return -1 }\n      }\n      return this.Subjects.indexOf(Value)\n    }\n\n  /**** slice ****/\n\n    slice (this:DOMMaLi, start?:number, end?:number):DOMMaLi {\n      return new _DOMMaLi(this.Subjects.slice(start,end))\n    }\n\n  /**** first ****/\n\n    first (this:DOMMaLi):DOMMaLi {\n      return new _DOMMaLi(this.Subjects[0])\n    }\n\n  /**** last ****/\n\n    last (this:DOMMaLi):DOMMaLi {\n      return new _DOMMaLi(this.Subjects[this.Subjects.length-1])\n    }\n\n  /**** eq ****/\n\n    eq (this:DOMMaLi, Index:number):DOMMaLi {\n      return new _DOMMaLi(this.Subjects[Index])\n    }\n\n  /**** forEach ****/\n\n    forEach (this:DOMMaLi, Callback:Function):DOMMaLi {\n      this.Subjects.forEach((Subject:Element, Index:number) => {\n        Callback(new _DOMMaLi(Subject), Index, this)\n      })\n      return this\n    }\n\n  /**** filter ****/\n\n    filter (this:DOMMaLi, SelectorOrCallback:string|String|Function):DOMMaLi {\n      if (typeof SelectorOrCallback === 'function') {\n        return new _DOMMaLi(\n          this.Subjects.filter((Subject:Element, Index:number) => {\n            return (SelectorOrCallback as Function)(\n              new _DOMMaLi(Subject), Index, this\n            )\n          })\n        )\n      } else {\n        return new _DOMMaLi(\n          this.Subjects.filter((Subject:Element) => {\n            return Subject.matches(unhashed(SelectorOrCallback as string))\n          })\n        )\n      }\n    }\n\n  /**** tagName ****/\n\n    tagName (this:DOMMaLi):string|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].tagName.toLowerCase()\n      )\n    }\n\n  /**** matches ****/\n\n    matches (this:DOMMaLi, Selector:string|String):boolean {\n      return this.Subjects.every(\n        (Subject:Element) => Subject.matches(unhashed(Selector as string))\n      )\n    }\n\n  /**** is ****/\n\n    is (this:DOMMaLi, Value:string|String|_DOMMaLi|Element):boolean {\n      switch (true) {\n        case ValueIsString(Value):\n          return this.matches(unhashed(Value as string))\n        case (Value instanceof _DOMMaLi):\n          let Candidate = Value as _DOMMaLi\n          return (\n            (this.Subjects.length === Candidate.Subjects.length) &&\n            this.Subjects.every(\n              (Element,Index) => (Candidate.Subjects[Index] === Element)\n            )\n          )\n          break\n        case (Value instanceof Element):\n          return (\n            (this.Subjects.length === 1) &&\n            (this.Subjects[0]     === Value)\n          )\n        default:\n          return false\n      }\n    }\n\n  /**** find ****/\n\n    find (this:DOMMaLi, Selector:string|String):DOMMaLi {\n      return new _DOMMaLi(\n        this.Subjects.length === 0\n        ? undefined\n        : asArray(this.Subjects[0].querySelectorAll(unhashed(Selector as string)))\n      )\n    }\n\n  /**** findFirst ****/\n\n    findFirst (this:DOMMaLi, Selector:string|String):DOMMaLi {\n      return new _DOMMaLi(\n        (this.Subjects.length === 0)\n        ? undefined\n        : this.Subjects[0].querySelector(unhashed(Selector as string)) as Element\n      )\n    }\n\n  /**** parent ****/\n\n    parent (this:DOMMaLi):DOMMaLi {\n      return new _DOMMaLi(\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].parentElement\n      )\n    }\n\n  /**** closest ****/\n\n    closest (this:DOMMaLi, Selector:string|String):DOMMaLi {\n      return new _DOMMaLi(\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].closest(unhashed(Selector as string))\n      )\n    }\n\n  /**** isAttached ****/\n\n    isAttached (this:DOMMaLi):boolean {\n      return (\n        this.Subjects.length === 0\n        ? false\n        : document.contains(this.Subjects[0])\n      )\n    }\n\n  /**** contains ****/\n\n    contains (this:DOMMaLi, Candidate:DOMMaLi):boolean {\n      return (\n        (this.Subjects.length === 0) || (Candidate.Subjects.length === 0)\n        ? false\n        : Candidate.Subjects.every((Candidate) => this.Subjects[0].contains(Candidate))\n      )\n    }\n\n  /**** children ****/\n\n    children (this:DOMMaLi, Selector?:string|String):DOMMaLi {\n      let ChildElements = (\n        this.Subjects.length === 0\n        ? []\n        : asArray(this.Subjects[0].children)\n      )\n\n      if (Selector != null) {\n        ChildElements = ChildElements.filter(\n          (Subject:Element) => Subject.matches(unhashed(Selector as string))\n        )\n      }\n\n      return new _DOMMaLi(ChildElements)\n    }\n\n  /**** firstChild ****/\n\n    firstChild (this:DOMMaLi, Selector?:string|String):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return new _DOMMaLi()\n      }\n\n      if (Selector == null) {\n        return new _DOMMaLi(this.Subjects[0].firstElementChild)\n      } else {\n        return new _DOMMaLi(\n          asArray(this.Subjects[0].children).find(\n            (Subject:Element) => Subject.matches(unhashed(Selector as string))\n          )\n        )\n      }\n    }\n\n  /**** lastChild ****/\n\n    lastChild (this:DOMMaLi, Selector?:string|String):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return new _DOMMaLi()\n      }\n\n      if (Selector == null) {\n        return new _DOMMaLi(this.Subjects[0].lastElementChild)\n      } else {\n        let ChildElements = asArray(this.Subjects[0].children)\n\n        for (let i = ChildElements.length-1; i >= 0; i--) {\n          if (ChildElements[i].matches(unhashed(Selector as string))) {\n            return new _DOMMaLi(ChildElements[i])\n          }\n        }\n        return new _DOMMaLi()\n      }\n    }\n\n  /**** prev ****/\n\n    prev (this:DOMMaLi, Selector?:string|String):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return new _DOMMaLi()\n      }\n\n      if (Selector == null) {\n        return new _DOMMaLi(this.Subjects[0].previousElementSibling)\n      } else {\n        let Sibling = this.Subjects[0].previousElementSibling\n          while (Sibling != null) {\n            if (Sibling.matches(unhashed(Selector as string))) {\n              return new _DOMMaLi(Sibling)\n            }\n            Sibling = Sibling.previousElementSibling\n          }\n        return new _DOMMaLi()\n      }\n    }\n\n  /**** next ****/\n\n    next (this:DOMMaLi, Selector?:string|String):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return new _DOMMaLi()\n      }\n\n      if (Selector == null) {\n        return new _DOMMaLi(this.Subjects[0].nextElementSibling)\n      } else {\n        let Sibling = this.Subjects[0].nextElementSibling\n          while (Sibling != null) {\n            if (Sibling.matches(unhashed(Selector as string))) {\n              return new _DOMMaLi(Sibling)\n            }\n            Sibling = Sibling.nextElementSibling\n          }\n        return new _DOMMaLi()\n      }\n    }\n\n  /**** positionInViewport - CONSIDERING transforms! ****/\n\n    positionInViewport (this:DOMMaLi):{ left:number,top:number }|undefined {\n      if (this.Subjects.length === 0) {\n        return undefined\n      }\n\n      let Bounds = this.Subjects[0].getBoundingClientRect()\n      return { left:Bounds.left, top:Bounds.top }\n    }\n\n  /**** positionInParent - without taking transforms into account ****/\n\n    positionInParent (this:DOMMaLi):{ left:number,top:number }|undefined {\n      if (\n        (this.Subjects.length === 0) ||\n        (this.Subjects[0].parentElement == null) ||\n        (! (this.Subjects[0] instanceof HTMLElement))\n      ) {\n        return undefined\n      }\n\n      let Subject = this.Subjects[0]\n      return (\n        Subject instanceof HTMLElement\n        ? { left:Subject.offsetLeft, top: Subject.offsetTop }\n        : undefined\n      )\n    }\n\n  /**** positionOnPage - without taking transforms into account ****/\n\n    positionOnPage (this:DOMMaLi):{ left:number,top:number }|undefined {\n      if (this.Subjects.length === 0) {\n        return undefined\n      }\n\n      let Bounds = this.Subjects[0].getBoundingClientRect()\n      return {\n        left:Bounds.left + document.body.scrollLeft,\n        top: Bounds.top  + document.body.scrollTop\n      }\n    }\n\n// see https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model/Determining_the_dimensions_of_elements\n// and https://jsbin.com/kimaxojufe/1/edit?css,js,console,output\n\n  /**** width - without taking transforms into account ****/\n\n    width (this:DOMMaLi, newValue?:number):number|DOMMaLi|undefined {\n      if (newValue === undefined) {\n        let Subject = this.Subjects[0]\n        if (Subject instanceof HTMLElement) {\n          return (Subject as HTMLElement).offsetWidth\n        } else {\n          return undefined\n        }\n      } else {\n        this.Subjects.forEach((Subject:Element) => {\n          if (Subject instanceof HTMLElement) {\n            Subject.style.width = newValue + 'px'\n          }\n        })\n        return this\n      }\n    }\n\n  /**** height - without taking transforms into account ****/\n\n    height (this:DOMMaLi, newValue?:number):number|DOMMaLi|undefined {\n      if (newValue === undefined) {\n        let Subject = this.Subjects[0]\n        if (Subject instanceof HTMLElement) {\n          return (Subject as HTMLElement).offsetHeight\n        } else {\n          return undefined\n        }\n      } else {\n        this.Subjects.forEach((Subject:Element) => {\n          if (Subject instanceof HTMLElement) {\n            Subject.style.height = newValue + 'px'\n          }\n        })\n        return this\n      }\n    }\n\n  /**** innerWidth/Height - without taking transforms into account ****/\n\n    innerWidth (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].clientWidth\n      )\n    }\n\n    innerHeight (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].clientHeight\n      )\n    }\n\n  /**** renderWidth/Height - CONSIDERING transforms ****/\n\n    renderWidth (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].getBoundingClientRect().width\n      )\n    }\n\n    renderHeight (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].getBoundingClientRect().height\n      )\n    }\n\n  /**** scrollLeft/Top/Width/Height ****/\n\n    scrollLeft (this:DOMMaLi, newValue?:number):number|DOMMaLi|undefined {\n      if (newValue === undefined) {\n        return (\n          this.Subjects.length === 0\n          ? undefined\n          : this.Subjects[0].scrollLeft\n        )\n      } else {\n        this.Subjects.forEach((Subject:Element) => {\n          Subject.scrollLeft = newValue\n        })\n        return this\n      }\n    }\n\n    scrollTop (this:DOMMaLi, newValue?:number):number|DOMMaLi|undefined {\n      if (newValue === undefined) {\n        return (\n          this.Subjects.length === 0\n          ? undefined\n          : this.Subjects[0].scrollTop\n        )\n      } else {\n        this.Subjects.forEach((Subject:Element) => {\n          Subject.scrollTop = newValue\n        })\n        return this\n      }\n    }\n\n    scrollWidth (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].scrollWidth\n      )\n    }\n\n    scrollHeight (this:DOMMaLi):number|undefined {\n      return (\n        this.Subjects.length === 0\n        ? undefined\n        : this.Subjects[0].scrollHeight\n      )\n    }\n\n  /**** scrollTo ****/\n\n    scrollTo (\n      this:DOMMaLi, x:number, y:number, Mode:'instant'|'smooth'|'auto' = 'auto'\n    ):DOMMaLi {\n      let Options = { left:x, top:y, behavior:Mode } as ScrollToOptions\n\n      this.Subjects.forEach((Subject:Element) => {\n        Subject.scrollTo(Options)\n      })\n\n      return this\n    }\n\n  /**** show ****/\n\n    show (this:DOMMaLi):DOMMaLi {\n      this.Subjects.forEach((Subject:indexableElement) => {\n        if (Subject instanceof HTMLElement) {\n          let computedStyle = getComputedStyle(Subject)\n          if (computedStyle.display !== 'none') { return }\n\n          if ((Subject as Indexable)['_preservedDisplay'] != null) {\n            Subject.style.display = (Subject as Indexable)['_preservedDisplay']// may set to ''\n          }\n\n          if (computedStyle.display === 'none') {\n            Subject.style.display = DisplayDefaultFor(Subject.tagName)\n          }\n        }\n      })\n      return this\n    }\n\n  /**** hide ****/\n\n    hide (this:DOMMaLi):DOMMaLi {\n      this.Subjects.forEach((Subject:Element) => {\n        if (Subject instanceof HTMLElement) {\n          let computedStyle = getComputedStyle(Subject)\n          if (computedStyle.display === 'none') { return }\n\n          (Subject as Indexable)['_preservedDisplay'] = Subject.style.display // may be ''\n          Subject.style.display = 'none'\n        }\n      })\n      return this\n    }\n\n  /**** hasClass ****/\n\n    hasClass (this:DOMMaLi, Classes:string):boolean {\n      if (this.Subjects.length === 0) {\n        return false\n      }\n\n      Classes = Classes.trim().replace(/\\s+/g,' ')\n      if (Classes === '') { return false }\n\n      let ClassList = this.Subjects[0].classList\n      return Classes.split(' ').every((Class:string) => ClassList.contains(Class))\n    }\n\n  /**** addClass ****/\n\n    addClass (this:DOMMaLi, Classes:string):DOMMaLi {\n      return this._processClasses(Classes,'add')\n    }\n\n  /**** toggleClass ****/\n\n    toggleClass (this:DOMMaLi, Classes:string):DOMMaLi {\n      return this._processClasses(Classes,'toggle')\n    }\n\n  /**** removeClass ****/\n\n    removeClass (this:DOMMaLi, Classes:string):DOMMaLi {\n      return this._processClasses(Classes,'remove')\n    }\n\n  /**** _processClasses ****/\n\n    private _processClasses (\n      this:DOMMaLi, Classes:string, Method:'add'|'toggle'|'remove'\n    ):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return this\n      }\n\n      Classes = Classes.trim().replace(/\\s+/g,' ')\n      if (Classes === '') { return this }\n\n      const ClassesToProcess = Classes.split(' ')\n\n      this.Subjects.forEach((Subject:Element) => {\n        let ClassList = Subject.classList\n        ClassesToProcess.forEach((Class) => ClassList[Method](Class))\n      })\n\n      return this\n    }\n\n  /**** append ****/\n\n    append (this:DOMMaLi, Content:string|String|DOMMaLi|Element|Element[]):DOMMaLi {\n      return this._insert(Content,'append')\n    }\n\n  /**** prepend ****/\n\n    prepend (this:DOMMaLi, Content:string|String|DOMMaLi|Element|Element[]):DOMMaLi {\n      return this._insert(Content,'prepend')\n    }\n\n  /**** insertAfter ****/\n\n    insertAfter (this:DOMMaLi, Content:DOMMaLi):DOMMaLi {\n      Content._insert(this,'after')\n      return this\n    }\n\n  /**** insertBefore ****/\n\n    insertBefore (this:DOMMaLi, Content:DOMMaLi):DOMMaLi {\n      Content._insert(this,'before')\n      return this\n    }\n\n  /**** _insert ****/\n\n    private _insert (\n      this:DOMMaLi, Content:string|String|DOMMaLi|Element|Element[],\n      Method:'append'|'prepend'|'after'|'before'\n    ):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return this\n      }\n\n      let Contents:DOMMaLi = (\n        Content instanceof DOMMaLi\n        ? Content as DOMMaLi\n        : new _DOMMaLi(Content)\n      )\n      if (Contents.Subjects.length === 0) { return this }\n\n      if (ValueIsString(Content) && (Content as string).startsWith('<')) {\n        this.Subjects.forEach((Subject:Element, Index:number) => {\n          Subject[Method].apply(Subject,Contents.Subjects)\n          if (Index < this.Subjects.length-1) {\n            Contents = new _DOMMaLi(Content as string)\n          }\n        })\n      } else {\n        this.Subjects[0][Method].apply(this.Subjects[0],Contents.Subjects)\n      }\n\n      return this\n    }\n\n  /**** replaceWith ****/\n\n    replaceWith (\n      this:DOMMaLi, Replacement:string|String|DOMMaLi|Element|Element[]\n    ):void {\n      if (this.Subjects.length === 0) { return }\n\n      let Replacements:DOMMaLi = (\n        Replacement instanceof DOMMaLi\n        ? Replacement as DOMMaLi\n        : new _DOMMaLi(Replacement)\n      )\n      if (Replacements.Subjects.length === 0) { this.remove(); return }\n\n      if (ValueIsString(Replacement) && (Replacement as string).startsWith('<')) {\n        this.Subjects.forEach((Subject:Element, Index:number) => {\n          Subject.replaceWith.apply(Subject,Replacements.Subjects)\n          if (Index < this.Subjects.length-1) {\n            Replacements = new _DOMMaLi(Replacement as string)\n          }\n        })\n      } else {\n        this.Subjects[0].replaceWith.apply(this.Subjects[0],Replacements.Subjects)\n      }\n    }\n\n  /**** remove ****/\n\n    remove (this:DOMMaLi):DOMMaLi {\n      if (this.Subjects.length === 0) {\n        return this\n      }\n\n      this.Subjects.forEach((Subject:Element) => {\n        Subject.remove()\n      })\n\n      return this\n    }\n\n  /**** prop ****/\n\n    prop (\n      this:DOMMaLi, Property:string, newValue?:any\n    ):DOMMaLi|any|undefined {\n      if (newValue === undefined) {\n        return (\n          this.Subjects.length === 0\n          ? undefined\n          : (this.Subjects[0] as Indexable)[Property]\n        )\n      } else {\n        this.Subjects.forEach((Subject:Indexable) => {\n          Subject[Property] = newValue\n        })\n        return this\n      }\n    }\n\n  /**** hasProp ****/\n\n    hasProp (this:DOMMaLi, Property:string):boolean {\n      return (\n        this.Subjects.length === 0\n        ? false\n        : Property in this.Subjects[0]\n      )\n    }\n\n  /**** removeProp ****/\n\n    removeProp (this:DOMMaLi, Property:string):DOMMaLi {\n      this.Subjects.forEach((Subject:Indexable) => {\n        delete Subject[Property]\n      })\n      return this\n    }\n\n  /**** data - not restricted to strings ****/\n\n    data (\n      this:DOMMaLi, Key:string, newValue?:any\n    ):DOMMaLi|any|undefined {\n      if (newValue === undefined) {\n        return (\n          (this.Subjects.length === 0) || ((this.Subjects[0] as Indexable)['_data'] == null)\n          ? undefined\n          : (this.Subjects[0] as Indexable)['_data'][Key]\n        )\n      } else {\n        this.Subjects.forEach((Subject:Indexable) => {\n          if (Subject['_data'] == null) {\n            Subject['_data'] = Object.create(null)\n          }\n          Subject['_data'][Key] = newValue\n        })\n        return this\n      }\n    }\n\n  /**** hasData ****/\n\n    hasData (this:DOMMaLi, Key:string):boolean {\n      return (\n        (this.Subjects.length > 0) &&\n        ((this.Subjects[0] as Indexable)['_data'] != null) &&\n        (Key in (this.Subjects[0] as Indexable)['_data'])\n      )\n    }\n\n  /**** removeData ****/\n\n    removeData (this:DOMMaLi, Key:string):DOMMaLi {\n      this.Subjects.forEach((Subject:Indexable) => {\n        if (Subject['_data'] != null) {\n          delete Subject['_data'][Key]\n        }\n      })\n      return this\n    }\n\n  /**** attr ****/\n\n    attr (\n      this:DOMMaLi, Attribute:string, newValue?:any\n    ):DOMMaLi|string|undefined {\n      if (newValue === undefined) {\n        if (this.Subjects.length === 0) { return undefined }\n\n        let Value = this.Subjects[0].getAttribute(Attribute)\n        return (Value === null ? undefined : Value)\n      } else {\n        if (newValue === null) {\n          return this.removeAttr(Attribute)\n        }\n\n        this.Subjects.forEach((Subject:Element) => {\n          Subject.setAttribute(Attribute,newValue)\n        })\n        return this\n      }\n    }\n\n  /**** hasAttr ****/\n\n    hasAttr (this:DOMMaLi, Attribute:string):boolean {\n      return (\n        this.Subjects.length === 0\n        ? false\n        : this.Subjects[0].hasAttribute(Attribute)\n      )\n    }\n\n  /**** removeAttr ****/\n\n    removeAttr (this:DOMMaLi, Attribute:string):DOMMaLi {\n      this.Subjects.forEach((Subject:Element) => {\n        Subject.removeAttribute(Attribute)\n      })\n      return this\n    }\n\n  /**** val ****/\n\n    val (\n      this:DOMMaLi, newValue?:any|null\n    ):DOMMaLi|string|undefined {\n      if (newValue === undefined) {\n        if (this.Subjects.length === 0) { return undefined }\n\n// @ts-ignore assume presence of \"value\" property\n        let Value = this.Subjects[0].value\n        return (Value === null ? undefined : Value)\n      } else {\n        this.Subjects.forEach((Subject:Element) => {\n// @ts-ignore assume presence of \"value\" property\n          Subject.value = newValue\n        })\n        return this\n      }\n    }\n\n  /**** css ****/\n\n    css (\n      this:DOMMaLi, PropertyOrListOrSet:string|string[]|PlainObject, newValue?:string\n    ):DOMMaLi|string|PlainObject|undefined {\n      if (newValue === undefined) {\n        let computedStyles:any\n        switch (true) {\n          case (typeof PropertyOrListOrSet === 'string'):\n            if (this.Subjects.length === 0) { return undefined }\n\n            computedStyles = window.getComputedStyle(this.Subjects[0]) as Indexable\n            return computedStyles[CamelCased(PropertyOrListOrSet as string)]\n          case ValueIsArray(PropertyOrListOrSet):\n            if (this.Subjects.length === 0) { return undefined }\n\n            computedStyles = window.getComputedStyle(this.Subjects[0])\n            let Result:PlainObject = {}\n              ;(PropertyOrListOrSet as string[]).forEach((Property:string) => {\n                Result[Property] = computedStyles[CamelCased(Property)]\n              })\n            return Result\n          default:\n            if (this.Subjects.length === 0) { return this }\n\n            for (let Property in PropertyOrListOrSet as PlainObject) {\n              if (PropertyOrListOrSet.hasOwnProperty(Property)) {\n                newValue = (PropertyOrListOrSet as PlainObject)[Property] as string\n                Property = CamelCased(Property)\n\n                this.Subjects.forEach((Subject:Element) => {\n                  if (Subject instanceof HTMLElement) {\n                    (Subject.style as Indexable)[Property] = newValue\n                  }\n                })\n              }\n            }\n            return this\n        }\n      } else {\n        if (typeof PropertyOrListOrSet === 'string') {\n          let Property = CamelCased(PropertyOrListOrSet as string)\n            this.Subjects.forEach((Subject:Element) => {\n              if (Subject instanceof HTMLElement) {\n                (Subject.style as Indexable)[Property] = newValue\n              }\n            })\n          return this\n        } else {\n          throw new TypeError('single attribute name expected')\n        }\n      }\n    }\n\n  /**** html ****/\n\n    html (this:DOMMaLi, newValue?:string):DOMMaLi|string|undefined {\n      if (newValue === undefined) {\n        return (\n          this.Subjects.length === 0\n          ? undefined\n          : this.Subjects[0].innerHTML\n        )\n      } else {\n        if (newValue === null) { newValue = '' }\n\n        this.Subjects.forEach((Subject:Element) => {\n          Subject.innerHTML = newValue as string\n        })\n        return this\n      }\n    }\n\n  /**** text ****/\n\n    text (this:DOMMaLi, newValue?:string):DOMMaLi|string|undefined {\n      if (newValue === undefined) {\n        return (\n          (this.Subjects.length === 0) || ! (this.Subjects[0] instanceof HTMLElement)\n          ? undefined\n          : this.Subjects[0].innerText\n        )\n      } else {\n        if (newValue === null) { newValue = '' }\n\n        this.Subjects.forEach((Subject:Element) => {\n          if (Subject instanceof HTMLElement) {\n            Subject.innerText = newValue as string\n          }\n        })\n        return this\n      }\n    }\n\n  /**** appendText ****/\n\n    appendText (this:DOMMaLi, Value:string):DOMMaLi {\n      this.Subjects.forEach((Subject:Element) => {\n        Subject.insertAdjacentText('beforeend',Value)\n      })\n      return this\n    }\n\n  /**** prependText ****/\n\n    prependText (this:DOMMaLi, Value:string):DOMMaLi {\n      this.Subjects.forEach((Subject:Element) => {\n        Subject.insertAdjacentText('afterbegin',Value)\n      })\n      return this\n    }\n\n  /**** on ****/\n\n    on (\n      this:DOMMaLi, Events:string, SelectorOrHandler:string|String|null|Function,\n      DataOrHandler?:any, Handler?:Function\n    ):DOMMaLi {\n      if (this.Subjects.length === 0) { return this }\n\n      return this._registerEventHandler(\n        Events,SelectorOrHandler,DataOrHandler,Handler\n      )\n    }\n\n  /**** once ****/\n\n    once (\n      this:DOMMaLi, Events:string, SelectorOrHandler:string|String|null|Function,\n      DataOrHandler?:any, Handler?:Function\n    ):DOMMaLi {\n      if (this.Subjects.length === 0) { return this }\n\n      return this._registerEventHandler(\n        Events,SelectorOrHandler,DataOrHandler,Handler, 'once'\n      )\n    }\n\n  /**** _registerEventHandler ****/\n\n    private _registerEventHandler (\n      this:DOMMaLi, Events:string, SelectorOrHandler?:string|String|null|Function,\n      DataOrHandler?:any, Handler?:Function, once?:'once'\n    ):DOMMaLi {\n      let ArgList = asArray(arguments).slice(1)\n\n      Events = Events.trim().replace(/\\s+/g,' ')\n      if (Events === '') { return this }\n\n      let Selector:string = (\n        ValueIsString(ArgList[0])\n        ? (ArgList.shift() as string).trim()\n        : (ArgList[0] == null ? ArgList.shift() || '' : '')\n      )                                                 // '' means: no selector\n\n      let Data:any = (\n        typeof ArgList[1] === 'function'\n        ? ArgList.shift()\n        : undefined\n      )\n\n      Handler = ArgList.shift() as Function\n\n      return this.__registerEventHandler(\n        Events,Selector,Data,Handler, once\n      )\n    }\n\n  /**** __registerEventHandler - on DOM element rather than DOMMaLi object ****/\n\n    private __registerEventHandler (\n      this:DOMMaLi, Events:string, Selector:string|String, Data:any,\n      Handler:Function, once?:'once'\n    ):DOMMaLi {\n      function actualHandler (Event:indexableEvent) {\n        switch (Selector) {\n          case '':\n            break\n          case '@this':\n            if (Event.target !== Event.currentTarget) { return }\n            break\n          default:\n            if (! (Event.target as Element).matches(Selector as string)) { return }\n        }\n\n        if (Data != null) { Event.data = Data }\n\n        if (once) {\n          (new _DOMMaLi(Event.currentTarget as Element))._unregisterAllEventHandlersMatching(\n            Event.type,Selector,Handler\n          )\n        }\n\n        let ArgList = [Event].concat(Event['_extraParameters'])\n        if (Handler.apply(new _DOMMaLi(Event.currentTarget as Element),ArgList) === false) {\n          Event.stopPropagation()\n          Event.preventDefault()\n        }\n      }\n      (actualHandler as indexableFunction)['isFor'] = Handler\n\n      Events.split(' ').forEach((Event:string) => {\n        this.Subjects.forEach((Subject:indexableElement) => {\n          let EventRegistry:Indexable = Subject['_EventRegistry']\n          if (EventRegistry == null) {\n            EventRegistry = Subject['_EventRegistry'] = Object.create(null)\n          }\n\n          let EntriesForEvent:Indexable = EventRegistry[Event]\n          if (EntriesForEvent == null) {\n            EntriesForEvent = EventRegistry[Event] = Object.create(null)\n          }\n\n          let EntriesForSelector:Function[] = EntriesForEvent[Selector as string]\n          if (EntriesForSelector == null) {\n            EntriesForSelector = EntriesForEvent[Selector as string] = []\n          }\n\n          EntriesForSelector.push(actualHandler)\n          Subject.addEventListener(Event,actualHandler)\n        })\n      })\n\n      return this\n    }\n\n  /**** off ****/\n\n    off (\n      this:DOMMaLi, Events?:string, SelectorOrHandler?:string|String|null|Function,\n      Handler?:Function\n    ):DOMMaLi {\n      if (this.Subjects.length === 0) { return this }\n\n      let ArgList = asArray(arguments).slice(1)\n\n      Events = (Events || '').trim().replace(/\\s+/g,' ')\n      if (Events === '') {\n        this._unregisterAllEventHandlersMatching()\n        return this\n      }\n\n      let Selector:string = (\n        ValueIsString(ArgList[0])\n        ? (ArgList.shift() as string).trim()\n        : (ArgList[0] === null ? ArgList.shift() || '' : undefined)\n      )            // \"null\" means: no selector, \"undefined\" means: any selector\n      if (Selector === undefined) {\n        this._unregisterAllEventHandlersMatching(Events)\n        return this\n      }\n\n      Handler = ArgList.shift()\n      if (Handler == null) {\n        this._unregisterAllEventHandlersMatching(Events,Selector)\n        return this\n      }\n\n      this._unregisterAllEventHandlersMatching(Events,Selector,Handler)\n\n      return this\n    }\n\n  /**** _unregisterAllEventHandlersMatching ****/\n\n    private _unregisterAllEventHandlersMatching (\n      this:DOMMaLi, Events?:string, Selector?:string|String|null, Handler?:Function\n    ):DOMMaLi {\n      this.Subjects.forEach((Subject:indexableElement) => {\n        let EventRegistry:Indexable = Subject['_EventRegistry']\n        if (EventRegistry == null) { return }\n\n        if (Events == null) {                   // unregister any event handlers\n          for (let Event in EventRegistry) {\n            this._unregisterHandlersForEventMatching(\n              Subject,EventRegistry, Event,Selector,Handler\n            )\n          }\n        } else {                // unregister handlers for the given events only\n          Events.split(' ').forEach((Event:string) => {\n            this._unregisterHandlersForEventMatching(\n              Subject,EventRegistry, Event,Selector,Handler\n            )\n          })\n        }\n\n        if (ValueIsEmptyObject(EventRegistry)) {\n          delete Subject['_EventRegistry']\n        }\n      })\n      return this\n    }\n\n  /**** _unregisterHandlersForEventMatching ****/\n\n    private _unregisterHandlersForEventMatching (\n      Subject:Element, EventRegistry:any,\n      Event:string, Selector?:string|String|null, Handler?:Function\n    ):void {\n      let EntriesForEvent:Indexable = EventRegistry[Event]\n      if (EntriesForEvent != null) {\n        if (Selector == null) {\n          for (let Selector in EntriesForEvent) {\n            this._unregisterHandlersForEventSelectorsMatching(\n              Subject,EntriesForEvent, Event,Selector,Handler\n            )\n          }\n        } else {\n          this._unregisterHandlersForEventSelectorsMatching(\n            Subject,EntriesForEvent, Event,Selector,Handler\n          )\n        }\n\n        if (ValueIsEmptyObject(EntriesForEvent)) {\n          delete EventRegistry[Event]\n        }\n      }\n    }\n\n  /**** _unregisterHandlersForEventSelectorsMatching ****/\n\n    private _unregisterHandlersForEventSelectorsMatching (\n      Subject:Element, EntriesForEvent:any,\n      Event:string, Selector:string|String, Handler?:Function\n    ):void {\n      let EntriesForSelector:Function[] = EntriesForEvent[Selector as string]\n      if (EntriesForSelector != null) {\n        if (Handler == null) {\n          EntriesForSelector.forEach((actualHandler:Function) => {\n// @ts-ignore TypeScript does not allow JS functions here, but that's wrong\n            Subject.removeEventListener(Event,actualHandler)\n          })\n          EntriesForSelector.length = 0\n        } else {\n          EntriesForSelector.every((actualHandler:indexableFunction, Index:number) => {\n            if (actualHandler['isFor'] === Handler) {\n// @ts-ignore TypeScript does not allow JS functions here, but that's wrong\n              Subject.removeEventListener(Event,actualHandler)\n              EntriesForSelector.splice(Index,1)\n              return false\n            }\n            return true\n          })\n        }\n\n        if (EntriesForSelector.length === 0) {\n          delete EntriesForEvent[Selector as string]\n        }\n      }\n    }\n\n  /**** trigger ****/\n\n    trigger (\n      this:DOMMaLi, Event:string|Event, extraParameters?:any, bubbles = true\n    ):boolean {\n      if (this.Subjects.length === 0) { return true }\n\n      if (ValueIsString(Event)) {\n        Event = new CustomEvent(Event as string, { bubbles, cancelable:true })\n      }\n\n      if (extraParameters != null) {\n        (Event as indexableEvent)['_extraParameters'] = (\n          ValueIsArray(extraParameters)\n          ? extraParameters.slice()\n          : [extraParameters]\n        )\n      }\n\n      return this.Subjects.reduce(\n        (Result:boolean,Subject:Element) => {\n          return Subject.dispatchEvent(Event as Event) && Result\n        }, true\n      )\n    }\n\n  /**** focus ****/\n\n    focus (this:DOMMaLi):DOMMaLi {\n      if ((this.Subjects.length > 0) && (this.Subjects[0] instanceof HTMLElement)) {\n        this.Subjects[0].focus()\n      }\n      return this\n    }\n\n  /**** blur ****/\n\n    blur (this:DOMMaLi):DOMMaLi {\n      if ((this.Subjects.length > 0) && (this.Subjects[0] instanceof HTMLElement)) {\n        this.Subjects[0].blur()\n      }\n      return this\n    }\n\n  /**** hasFocus ****/\n\n    hasFocus (this:DOMMaLi):boolean {\n      return (document.activeElement === this.Subjects[0])\n    }\n\n  /**** focusedElement ****/\n\n    focusedElement (this:DOMMaLi):DOMMaLi{\n      return new _DOMMaLi(document.activeElement)\n    }\n\n  /**** transition ****/\n\n    transition (\n      this:DOMMaLi, Settings:PlainObject, Options?:PlainObject\n    ):DOMMaLi {\n      if (this.Subjects.length === 0)   { return this }\n      if (ValueIsEmptyObject(Settings)) { return this }\n\n      Options = Object.assign({}, {\n        delay:'0ms', duration:'400ms', easing:'linear',\n        cleanup:true\n      }, Options)\n\n      let TransitProps = ''\n      for (let Key in Settings) {\n        if (Settings.hasOwnProperty(Key)) {\n          TransitProps += (TransitProps === '' ? '' : ',') + Key\n        }\n      }\n\n      let TransitDuration = (\n        ValueIsString(Options.duration) ? Options.duration : (Options.duration + 'ms')\n      )\n\n      let TransitDelay = (\n        ValueIsString(Options.delay) ? Options.delay : (Options.delay + 'ms')\n      )\n\n      if (Options.cleanup == true) {\n        this.Subjects.forEach((Subject) => {\n          if (Subject instanceof HTMLElement) {\n            let previousTransition = window.getComputedStyle(Subject).transition\n\n            Subject.addEventListener('transitionend', (Event) => {\n              Subject.style.transition = previousTransition\n            }, { once:true })\n          }\n        })\n      }\n\n      this.Subjects.forEach((Subject) => {\n        if (Subject instanceof HTMLElement) {\n          Subject.style.transitionProperty       = TransitProps    as string\n          Subject.style.transitionDelay          = TransitDelay    as string\n          Subject.style.transitionDuration       = TransitDuration as string\n// @ts-ignore no, \"Options\" is never undefined\n          Subject.style.transitionTimingFunction = Options.easing  as string\n\n          for (let Key in Settings) {\n            if (Settings.hasOwnProperty(Key)) {\n              let newValue = (Settings as PlainObject)[Key] as string\n              let Property = CamelCased(Key)\n\n              ;(Subject.style as Indexable)[Property] = newValue\n            }\n          }\n        }\n      })\n\n      return this\n    }\n  }\n\n/**** apply any synonyms ****/\n\n  Object.assign(DOMMaLi.prototype, {\n    renderPositionInViewport: DOMMaLi.prototype.positionInViewport,\n    layoutPositionInParent:   DOMMaLi.prototype.positionInParent,\n    layoutPositionOnPage:     DOMMaLi.prototype.positionOnPage,\n\n    layoutWidth:  DOMMaLi.prototype.width,\n    layoutHeight: DOMMaLi.prototype.height,\n\n    outerWidth:  DOMMaLi.prototype.width,\n    outerHeight: DOMMaLi.prototype.height,\n  })\n\n/**** startup function handling ****/\n\n  let DOMisReady = (document.readyState !== 'loading')\n  if (! DOMisReady) {\n    window.addEventListener('DOMContentLoaded', () => {\n      DOMisReady = true\n      invokeAllReadyFunctionsToCall()\n    })\n  }\n\n/**** invokeAllReadyFunctionsToCall ****/\n// ReadyFunctionsToCall may be extended while invokeAllReadyFunctionsToCall is running!\n\n  const ReadyFunctionsToCall:Function[] = []\n  let ReadyFunctionsAreRunning:boolean  = false\n\n  function invokeAllReadyFunctionsToCall ():void {\n    ReadyFunctionsAreRunning = true\n      for (let i = 0; i < ReadyFunctionsToCall.length; i++) {\n        try {\n          ReadyFunctionsToCall[i]()\n        } catch (signal) {\n          console.error('registered dommali \"ready\" handler failed with ',signal)\n        }\n      }\n    ReadyFunctionsAreRunning = false\n  }\n\n  class _DOMMaLi extends DOMMaLi {\n    constructor (Value?:string|String|DOMMaLi|Element|Element[]|null|undefined) {\n      super()\n\n      switch (true) {\n        case (Value == null):\n          this.Subjects = []\n          break\n        case ValueIsArray(Value):\n          this.Subjects = Value as Element[]      // important: array REFERENCE!\n          break\n        case ValueIsString(Value):\n          if ((Value as string).startsWith('<')) {\n            const Template = document.createElement('template')\n              Template.innerHTML = Value as string\n            this.Subjects = asArray(Template.content.children)\n          } else {\n            this.Subjects = asArray(document.querySelectorAll(unhashed(Value as string)))\n          }\n          break\n        case (Value instanceof _DOMMaLi):\n          this.Subjects = (Value as _DOMMaLi).Subjects.slice()\n          break\n        case (Value instanceof Element):\n          this.Subjects = [Value as Element]\n          break\n        default:\n          throw new TypeError('unsupported \"dommali\" constructor argument')\n      }\n    }\n  }\n\n  export default function dommali (\n    Value:Function|string|String|DOMMaLi|Element|Element[]\n  ):DOMMaLi|typeof DOMMaLi {\n    switch (true) {\n      case (typeof Value === 'function'):\n        return DOMMaLi.ready(Value as Function)\n      case ValueIsArray(Value):\n        return new _DOMMaLi(asArray(Value as Element[]))\n      default:\n        return new _DOMMaLi(Value as any)\n    }\n  }\n\n  Object.assign(dommali, { ready:DOMMaLi.ready })\n\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","ValueIsString","Value","String","ValueIsArray","isArray","asArray","slice","ValueIsEmptyObject","Key","CamelCased","Text","replace","Match","toUpperCase","DisplayDefaultSet","unhashed","Selector","startsWith","DOMMaLi","this","Subjects","ready","FunctionToCall","DOMisReady","ReadyFunctionsAreRunning","ReadyFunctionsToCall","push","textWidth","TemplateOrSettings","_DOMMaLi","_auxiliarySpan","auxiliarySpan_1","document","createElement","style","visibility","body","appendChild","dommali","auxiliarySpan_2","css","width","margin","padding","border","font","Settings_1","getPrototypeOf","Element","window","getComputedStyle","subject","TypeError","_relevantSettings_for_textWidth","forEach","relevantSetting","ValueOfSetting","text","NaN","textHeight","_auxiliaryDiv","auxiliaryDiv_1","auxiliaryDiv_2","Settings_2","_relevantSettings_for_textHeight","height","defineProperty","get","length","size","isEmpty","subjects","Index","indexOf","start","end","first","last","eq","Callback","_this","Subject","filter","SelectorOrCallback","matches","tagName","undefined","toLowerCase","every","is","Candidate_1","find","querySelectorAll","findFirst","querySelector","parent","parentElement","closest","isAttached","contains","Candidate","children","ChildElements","firstChild","firstElementChild","lastChild","lastElementChild","i","prev","previousElementSibling","Sibling","next","nextElementSibling","positionInViewport","Bounds","getBoundingClientRect","left","top","positionInParent","HTMLElement","offsetLeft","offsetTop","positionOnPage","scrollLeft","scrollTop","newValue","offsetWidth","offsetHeight","innerWidth","clientWidth","innerHeight","clientHeight","renderWidth","renderHeight","scrollWidth","scrollHeight","scrollTo","x","y","Mode","Options","behavior","show","computedStyle","display","TagName","auxElement","DisplayDefault","removeChild","DisplayDefaultFor","hide","hasClass","Classes","trim","ClassList","classList","split","Class","addClass","_processClasses","toggleClass","removeClass","Method","ClassesToProcess","append","Content","_insert","prepend","insertAfter","insertBefore","Contents","apply","replaceWith","Replacement","Replacements","remove","prop","Property","hasProp","removeProp","data","create","hasData","removeData","attr","Attribute","getAttribute","removeAttr","setAttribute","hasAttr","hasAttribute","removeAttribute","val","value","PropertyOrListOrSet","Property_1","computedStyles_1","Result_1","this_1","html","innerHTML","innerText","appendText","insertAdjacentText","prependText","on","Events","SelectorOrHandler","DataOrHandler","Handler","_registerEventHandler","once","ArgList","arguments","shift","Data","__registerEventHandler","actualHandler","Event","target","currentTarget","_unregisterAllEventHandlersMatching","type","concat","stopPropagation","preventDefault","EventRegistry","EntriesForEvent","EntriesForSelector","addEventListener","off","Event_1","_unregisterHandlersForEventMatching","Selector_1","_unregisterHandlersForEventSelectorsMatching","removeEventListener","splice","trigger","extraParameters","bubbles","CustomEvent","cancelable","reduce","Result","dispatchEvent","focus","blur","hasFocus","activeElement","focusedElement","transition","Settings","assign","delay","duration","easing","cleanup","TransitProps","TransitDuration","TransitDelay","previousTransition_1","transitionProperty","transitionDelay","transitionDuration","transitionTimingFunction","renderPositionInViewport","layoutPositionInParent","layoutPositionOnPage","layoutWidth","layoutHeight","outerWidth","outerHeight","readyState","signal","console","error","invokeAllReadyFunctionsToCall","_super","Template","content","__","constructor","__extends"],"mappings":"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"}